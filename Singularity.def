Bootstrap: docker
From: continuumio/miniconda3

%post
    apt-get -y update
    apt-get -y upgrade
    apt-get install -y libgl1-mesa-glx
    # Create a conda environment using the provided file
    conda env create -f /tmp/environment.yml

    # Create directories
    mkdir -p /tmp
    mkdir -p /local_scratch

%environment
    export PATH=/opt/conda/envs/hpc/bin:$PATH

%runscript
    source activate hpc
    cd /local_scratch
